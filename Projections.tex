\documentclass[a4paper,10pt]{article}
\usepackage{paper}

\def\thetitle{Cyclic projections in Hadamard spaces}
\def\theauthors{Alexander Lytchak and Anton Petrunin}
\hypersetup{
pdftitle={\thetitle},
pdfauthor={\theauthors}
}

\begin{document}


\title{\thetitle}	
\author{\theauthors}
\date{\today}
\maketitle

\begin{abstract}
	We  prove that iterating projections onto convex subsets of Hadamard spaces can behave in a more complicated way than in Hilbert spaces, resolving a problem formulated by Miroslav Bacak. 	
\end{abstract}

%\begin{keywords}
%CAT(0), metric porjections, convex subset
%\end{keywords}
%\subjclass[2010]{53C20, 53C21, 53C23}
%\pagestyle{empty}\thispagestyle{empty}

\section{Introduction}


Let  $C_1,\dots, C_k$ be closed convex subsets in a Hadamard space $X$.
Denote by $P_i$ the closest-point projection $X\to C_i$; it sends a point $x\in X$ to the (necessarily unique) point in $C_i$ that minimize the distance to $x$.
Given a point $x\in X$ consider the sequence $x_n=P^n(x)$, where
$P= P_1\circ \dots \circ P_k$.
Various properties of such compositions  $P$ and arising  sequences $x_n$
are classical topics of research, especially in Hilbert spaces, originated from convex optimization, see \cite{Bac, Bac2, Bauschke}
and the bibliography therein.

If $X$ is a Hilbert space, then the fundamental result of Heinz Bauschke \cite{Bauschke,Kohlenbach}, states that the map $P$ is \emph{asymptotically regular}, that is, for any $x$, we have  $|x_n-x_{n+1}|\to 0$ as $n\to \infty$.
In this note we show that this statement does not hold in general Hadamard spaces, despite the fact that many related statements
admit generalizations and, thus, depend only on the convexity properties of the distance functions and not on the linear structure. 
That answers the question of Miroslav Bacak \cite[Problem 6.13]{Bac}.

\begin{thm}{Theorem}\label{thm}
There exists a Hadamard space $X$ and closed convex subsets $C_1,\dots,C_k$ in $X$ such that the composition of the closest-point projections $P= P_1\circ \dots \circ P_k$ is not asymptotically regular.

Moreover, we can arrange that $X$ is compact, $k=3$, each $C_i$ is isometric to the unit interval $[0,1]$, 
and $P$ is an isometry of $C_1$ that swaps its ends.
\end{thm}

The constructed space contains three convex flat quadrangles $Q_1$, $Q_2$, and $Q_3$ with pairs of opposite sides $(C_1,C_2)$, $(C_2,C_3)$, and $(C_3,C_1)$ such that the union of $Q_1\cup Q_2\cup Q_3$ is a Möbius band.

If the sets $C_1,\dots,C_k$ have a common intersection, then such examples are impossible \cite{asymptotic,Bac2,Bac}.

It is possible to vary the construction and obtain a compact Hadamard space $X$ and a finite sequence of convex subsets $C_1,\dots,C_k$ all isometric to the unit disc, such that the composition $P=P_1\circ \dots\circ      P_k :C_1\to C_1$  is a rotation of the disc by an arbitrary (especially an irrational) angle.

On the other hand, in case of two subsets the result of  Heinz Bauschke \cite{Bauschke} admits a generalization:

\begin{thm}{Proposition} \label{prop}
For any two closed convex subsets $C_1,C_2$ of any Hadamard space $X$, for any starting point $x\in X$  the sequence $x_n = P^n (x)$ with $P=  P_1\circ P_2 :X\to C_1$ is asymptotically  regular.

Moreover, for any $x$, there is a constant $A$ such that 
$|x_n-x_{n+1}| \leq \frac  {A} {\sqrt n}$;
where $|x_n-x_{n+1}|$ denotes the distance between the points $x_n$ and $x_{n+1}$ in $X$.
\end{thm}

Further, we assume some familiarity with the geometry of Hadamard spaces \cite{BBI,BH,AKP,AKP_inv,ballmannbook}.


\section{Two sets}


\begin{wrapfigure}{r}{50mm}
\vskip-6mm
\centering
\includegraphics{mppics/pic-10}
\end{wrapfigure}

\mbox{\parit{Proof of \ref{prop}.}}
By definition,  $x_n \in C_1$ for all $n$.
Set $y_n= P_2 (x_n)$, so $y_n$ is the closest-point projection of $x_n$ to $C_2$.
Further set 
\begin{align*}
r_n&:=|x_n-x_{n+1}|,\\
s_n&:=|y_n-y_{n+1}|.
\end{align*}
Note that 
\[r_1 \geq s_1 \geq r_2\geq s_2\geq\dots
\eqlbl{eq:rsrsrsrs}
\]

Set
\begin{align*}
a_n &\df |x_n-y_n|= \dist_{C_2}x_n,\\
 b_n &\df |y_n-x_{n+1}|= \dist_{C_1}y_n.
\end{align*}
Note that
\[a_1 \geq b_1 \geq a_2 \geq b_2 \geq \dots
\eqlbl{eq:abababa}\]

Since $C_1$ is convex and $x_{n+1}\in C_1$ lies at the minimal distance from $y_n$, we have $\measuredangle[x_{n+1}\,{}^{x_n}_{y_n}]\ge \tfrac\pi2$. 
By CAT(0) comparison
% $\tilde\measuredangle(x_{n+1}\,{}^{x_n}_{y_n})\ge \tfrac\pi2$.
%it implies that 
\[r_n^2  \leq a_n^2-b_n^2.\]
Therefore \ref{eq:abababa} implies that 
\[\sum_{n} r_n ^2\le a_1^2.\]
By \ref{eq:rsrsrsrs}, $r_n$ is non-increasing.
Therefore $r_n \leq \tfrac A {\sqrt{n}}$, for some constant~$A$.
\qeds

\section{Three sets}

\parit{Proof of Theorem \ref{thm}.}
Fix a small $\epsilon >0$.
Consider the unit sphere~$\mathbb{S}^2$ and the closed 
$\epsilon$-neighborhood $A$ of its equator.
The space $A$ is locally CAT(1) by \cite {ABB-1993}.
%one can get it as a corollary of the result in \cite{LWcurv}.
The universal cover $\tilde A$ of $A$ with its induced metric is locally CAT(1) as well. 

Denote by $E$ the preimage of the equator in $\tilde A$  and by $H^{\pm}$ the boundary curves of the stripe $\tilde A$, which are both convex in $\tilde A$.
The isometry group of $\tilde A$ 
contains the group of translations  along $E$ (the preimage of rotations of the sphere) and 
the reflection across $E$ that swaps $H^+$ and $H^-$.
Let $g$   be the composition of translation along $E$  of length $2\pi +10\cdot\epsilon$  and the reflection $r$.
The element $g$ generates a discrete group $\Gamma$ isomorphic to $\mathbb Z$ in the group of isometries  of $\tilde A$.
The group $\Gamma$ acts freely on $\tilde A$ and the quotient space $Y =\tilde A/\Gamma$ is a Möbius band.

Since $\eps$ is small, every point of $\tilde A$ is moved by any element of $\Gamma$ more than $2\cdot\pi$ away from it.
It implies that the compact locally CAT(1) space $Y$ does not  contain geodesics of length less than $2\pi$;
hence, by  the generalized Hadamard--Cartan theorem \cite{AKP}, $Y$ is CAT(1).
By construction, $Y$ is locally isometric to $\mathbb{S}^2$ outside its boundary curve $B$.
The projection of $E$ to $Y$ is a closed geodesic $G$ of length $2\pi +10\cdot\epsilon$.

Denote by $X$ the Euclidean cone over $Y$;
since $Y$ is CAT(1), we get that $X$ is CAT(0); see \cite{AKP}.
Moreover, $X$ is locally Euclidean outside its \emph{boundary} --- the cone over $B$.

The cone $Z$ over the closed geodesic $G$ is  the Euclidean cone over a circle of length $2\pi +10\cdot\epsilon$. By construction,
$Z$ is locally convex, hence a convex subset of~$X$.
Let us consider a geodesic triangle
$[q_1q_2q_3]$
in $Z$ that surrounds the origin $o$ of the cone $Z$.

By construction, the triangle $[q_1q_2q_3]$ is contained in the flat part of $X$.
Thus, we can find a small $r>0$ such that the $r$-neighborhood $U_1$ of the geodesic $[q_1q_2]$ isometric to a convex subset of the Euclidean space.
We can assume that $r$-neighborhoods $U_2$ of $[q_2q_3]$ and $U_3$ of $[q_3q_1]$ have the same property.

Denote by $C_i$ the segment of length $r$ centered at $q_i$ and being orthogonal to $Z$ at $q_i$.
By construction, $C_i$ and $C_{i+1}$, for $i=1,2,3\pmod 3$   are contained in~$U_i$.
Since $Z$ is convex, $C_i$ and $C_{i+1}$ are \emph{parallel} inside $U_i$, thus their convex hull  $Q_i$ is isometric to a rectangle with two opposite sides given by $C_i$ and $C_{i+1}$.
In particular, the metric projection from $C_{i+1}$ to $C_{i}$ is an isometry.

Note that the central projection $Q_1\cup Q_2\cup Q_3\to Y$ is an embedding.
It follows that the union $Q_1\cup Q_2\cup Q_3$ is homeomorphic to the Möbius band.
Thus, \emph{going around} we change the orientation of $C_1$.
It means, that the composition $P:C_1\to C_1$ (which is an isometry by construction) changes the orientation of the 
segment $C_1$.

The constructed space $X$ is not compact, but  the convex subsets $C_1,C_2,C_3$ are contained in some closed  ball of some radius around the vertex.  We finish the construction replacing $X$ with any such ball.	
\qeds

The same construction works in higher dimensions.
Namely, instead of $A$, we may choose a tubular neighborhood of a closed geodesic in $\mathbb{S}^m$;
by the result of Stephanie Alexander,  David Berg, and Richard Bishop \cite{ABB-1993}, the space $A$ is CAT(1).
Instead of $g$, we may take glide rotation of the $\tilde A$.
That gives a variation of the construction with $C_i$ isometric to a Euclidean disc and $P$ acting on $C_1$ by an arbitrary rotation.

{\sloppy
\printbibliography[heading=bibintoc]
\fussy
}

\end{document}	


