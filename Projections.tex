\documentclass[a4paper,10pt]{article}
\usepackage{paper}

\def\thetitle{Cyclic projections in Hadamard spaces}
\def\theauthors{Alexander Lytchak and Anton Petrunin}
\hypersetup{
pdftitle={\thetitle},
pdfauthor={\theauthors}
}

\begin{document}


\title{\thetitle}	
\author{\theauthors}
\date{}
\maketitle

\begin{abstract}
	We  prove that iterating projections onto convex subsets of Hadamard spaces can behave in a more complicated way than in Hilbert spaces, resolving a problem formulated by Miroslav Bačák.
\end{abstract}

%\begin{keywords}
%CAT(0), Hadamard space, asymptotic regularity, metric projection
%\end{keywords}
%\subjclass[2010]{53C20, 53C21, 53C23}
%\pagestyle{empty}\thispagestyle{empty}

\section{Introduction}


Let  $C_1,\dots, C_k$ be closed convex subsets in a Hadamard space $X$.
Denote by $P_i$ the closest-point projection $X\to C_i$; it sends a point $x\in X$ to the (necessarily unique) point $P(x)$ in $C_i$ that minimize the distance to $x$.
Given a point $x\in X$ consider the sequence $x_n=P^n(x)$, where
$P= P_1\circ \dots \circ P_k$.
Various properties of such compositions  $P$ and arising  sequences $x_n$
are classical topics of research, especially in Hilbert spaces, originated from convex optimization, see \cite{Bac, Bac2, Bauschke, bauschke-borwein-lewis,deutsch-hundal}
and the bibliography therein.

If $X$ is a Hilbert space, then the fundamental result of Heinz Bauschke \cite{Bauschke,Kohlenbach}, states that the map $P$ is \emph{asymptotically regular}; that is, for any $x$, we have  $|x_n-x_{n+1}|\to 0$ as $n\to \infty$.
In this note we show that this statement does not hold in general Hadamard spaces, despite the fact that many related statements
admit generalizations and, thus, depend only on the convexity properties of the distance functions and not on the linear structure. 
That answers the question of Miroslav Bačák \cite[Problem 6.13]{Bac}.

We will denote by $|x-y|$ the distance between points $x$ and $y$ in any metric space, even without linear structure.

\begin{thm}{Theorem}\label{thm}
There exists a Hadamard space $X$ and closed convex subsets $C_1,\dots,C_k$ in $X$ such that the composition of the closest-point projections $P\z= P_1\circ \dots \circ P_k$ is not asymptotically regular.
\end{thm}

If the sets $C_1,\dots,C_k$ have a common intersection, then such examples are impossible \cite{asymptotic,Bac2,Bac}.

We provide two explicit examples proving the theorem  for  $k=3$.
Setting $C_3=\dots=C_k$ defines examples for any $k\geq 3$.

In the first example (Section \ref{sec:tripods}), the constructed space is a product of two tripods;
it contains three convex flat quadrangles $Q_1$, $Q_2$, and $Q_3$ with pairs of opposite sides $(C_1,C_2)$, $(C_2,C_3)$, and $(C_3,C_1)$ such that the composition of projections swaps the ends of $C_1$.

In the second example (Section \ref{sec:discs}), the convex subsets $C_1,C_2,C_3$ are isometric to the unit disc, and the composition $P\:C_1\z\to C_1$ rotates the disc by an arbitrary angle.
If the angle is chosen irrational, then no power of $P$ is asymptotically regular.
 
For $k=2$, the result of Heinz Bauschke \cite{Bauschke} admits a generalization:

\begin{thm}{Proposition} \label{prop}
Let $C_1,C_2$ be two closed convex subsets of a Hadamard space $X$.
Then the composition $P\z=  P_1\circ P_2$ is asymptotically  regular.

Moreover, $|x_n-x_{n+1}| =o (\frac  {1} {\sqrt n})$ for any  $x\in X$ and $x_n \z= P^n (x)$.
\end{thm}

Examples given by the real axes $C_1 \subset \R^2$ and the set
\[C_2  = \{\,(x,y):x>0, y \geq 1+ x^{ -\epsilon}\,\}\]
reveal that the convergence rate cannot be improved to $O (n^{-\frac 1 2  -\epsilon})$ for any $\epsilon >0$.

\medskip

Further, we assume familiarity with the geometry of Hadamard spaces \cite{BBI,BH,AKP,AKP_inv,ballmannbook}.

\parbf{Acknowledgments.}
We thank Miroslav Bačák and Nina Lebedeva for helpful comments and conversations.
Alexander Lytchak was partially supported by the DFG grant, no. 281071066, TRR 191.
Anton Petrunin was partially supported by the NSF grant, DMS-2005279.

\section{Product of tripods}\label{sec:tripods}

A union of three unit segments that share one endpoint with the induced length metric will be called a \emph{tripod}.
Consider two tripods $S$ and $T$.
Denote by $a$, $b$, $c$ and $x$, $y$, $z$ the sides of $S$ and $T$ respectively.
\begin{figure}[h!]
\vskip0mm
\centering
\includegraphics{mppics/pic-20}
\end{figure}

By the Reshetnyak gluing theorem, $S$ and $T$ are CAT(0).
Therefore, so is the product space $X=S\times T$.
The following diagram shows 3 isometric copies of $2{\times}2$-square in $X$; they are obtained as the products of two pairs of sides in $S$ and $T$ as labeled:
\begin{figure}[ht!]
\vskip0mm
\centering
\includegraphics{mppics/pic-30}
\end{figure}

Consider the segment $C_1$, $C_2$, and $C_3$ shown on the diagram;
they all have slope $-1$ and project to each other isometrically.
Note that each projection $P_i$ reverses the shown orientation.
It follows that the cyclic projection $P\:C_1\to C_1$ swaps the ends of $C_1$.
In particular, $P$ is \emph{not} asymptotically regular.


\section{Three discs}\label{sec:discs}

Fix an angle $\alpha$ and a small $\epsilon>0$.
Consider the closed 
$\epsilon$-neighborhood $A$ of a closed geodesic in the unit sphere~$\mathbb{S}^3$.
By the result of Stephanie Alexander,  David Berg, and Richard Bishop \cite {ABB-1993}, the space $A$ is locally CAT(1).
The universal cover $\tilde A$ of $A$ with its induced metric is locally CAT(1) as well. 

Denote by $E$ the preimage of the geodesic in $\tilde A$.
The isometry group of $\tilde A$ 
contains the group of translations along $E$ and 
the rotations that fix $E$.
Let $T$  be the composition of translation along $E$  of length $2\pi +10\cdot\epsilon$ and the rotation by angle $\alpha$.
The element $T$ generates a discrete subgroup $\Gamma$ in the group of isometries  of $\tilde A$ that acts freely.

Set $Y =\tilde A/\Gamma$.
Since $\eps$ is small, every point of $\tilde A$ is moved by any element of $\Gamma$ more than $2\cdot\pi$.
Therefore, $Y$ is a compact locally CAT(1) space that does not contain closed geodesics of length less than $2\pi$.
Hence, by  the generalized Hadamard--Cartan theorem \cite{AKP}, $Y$ is CAT(1).
By construction, $Y$ is locally isometric to $\mathbb{S}^3$ outside its boundary $B$.
The projection of $E$ to $Y$ is a closed geodesic $G$ of length $2\pi +10\cdot\epsilon$.

Denote by $X$ the Euclidean cone over $Y$;
since $Y$ is CAT(1), we get that $X$ is CAT(0); see \cite{AKP}.
Moreover, $X$ is locally Euclidean outside its \emph{boundary} --- the cone over $B$.

The cone $Z$ over the closed geodesic $G$ is  the Euclidean cone over a circle of length $2\pi +10\cdot\epsilon$.
By construction, $Z$ is locally convex, hence a convex subset of~$X$ \cite[2.2.12]{AKP_inv}.
Let us consider a geodesic triangle
$[q_1q_2q_3]$
in $Z$ that surrounds the origin $o$ of the cone $Z$.

By construction, the sides of triangle $[q_1q_2q_3]$ lie in the flat part of $X$.
Thus, we can find a small $r>0$ such that the $2\cdot r$-neighborhood $U_1$ of the geodesic $[q_1q_2]$ isometric to a convex subset of the Euclidean space.
We can assume that $2\cdot r$-neighborhoods $U_2$ of $[q_2q_3]$ and $U_3$ of $[q_3q_1]$ have the same property.

Denote by $C_i$ the disc of radius $r$ centered at $q_i$ and being orthogonal to~$Z$.
By construction, $C_i$ and $C_{i+1}$, for $i=1,2,3\pmod 3$   are contained in~$U_i$.
Since $Z$ is convex, $C_i$ and $C_{i+1}$ are \emph{parallel} inside $U_i$, thus their convex hull  $Q_i$ is isometric to a right cylinder with bases $C_i$ and $C_{i+1}$.
In particular, the projection $P_i$ defines an isometry $C_{i+1}\to C_{i}$.

By construction, the composition $P=P_1\circ P_2\circ P_3\:C_1\to C_1$ rotates $C_1$ by angle $\alpha$.
If $\tfrac\alpha\pi$ is irrational, then $P$, as well as all its powers, are \emph{not} asymptotically regular.


\section{Two sets}


\begin{wrapfigure}{r}{50mm}
\vskip-11mm
\centering
\includegraphics{mppics/pic-10}
\end{wrapfigure}

\mbox{\parit{Proof of \ref{prop}.}}
By definition,  $x_n \in C_1$ for all~$n$.
Set $y_n= P_2 (x_n)$, so $y_n$ is the closest-point projection of $x_n$ to $C_2$.
Further set 
\begin{align*}
r_n&:=|x_n-x_{n+1}|,\\
s_n&:=|y_n-y_{n+1}|.
\end{align*}
Since the closest-point projection is nonexpanding, we get
\[r_1 \geq s_1 \geq r_2\geq s_2\geq\dots
\eqlbl{eq:rsrsrsrs}
\]

Set
\begin{align*}
a_n &\df |x_n-y_n|= \dist_{C_2}x_n,\\
 b_n &\df |y_n-x_{n+1}|= \dist_{C_1}y_n.
\end{align*}
Note that
\[a_1 \geq b_1 \geq a_2 \geq b_2 \geq \dots
\eqlbl{eq:abababa}\]

Since $C_1$ is convex and $x_{n+1}\in C_1$ lies at the minimal distance from $y_n$, we have $\measuredangle[x_{n+1}\,{}^{x_n}_{y_n}]\ge \tfrac\pi2$. 
By CAT(0) comparison,
\[r_n^2  \leq a_n^2-b_n^2.\]
Therefore, \ref{eq:abababa} implies that 
\[\sum_{n} r_n ^2\le a_1^2.\]
By \ref{eq:rsrsrsrs}, $r_n$ is non-increasing.
Therefore, $r_n = o(\tfrac1{\sqrt{n}})$.
\qeds


{\sloppy
\printbibliography[heading=bibintoc]
\fussy
}

\end{document}	


